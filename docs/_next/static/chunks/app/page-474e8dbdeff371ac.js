(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4100:function(e,t,r){Promise.resolve().then(r.bind(r,9664))},8885:function(e){"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,n){var i;function s(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",s),r([].slice.call(arguments))}p(e,t,o,{once:!0}),"error"!==t&&(i={once:!0},"function"==typeof e.on&&p(e,"error",s,i))})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=u(e))>0&&o.length>i&&!o.warned){o.warned=!0;var i,s,o,c=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):v(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(e,t){for(var r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var o,a=Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[e];if(void 0===u)return!1;if("function"==typeof u)n(u,this,t);else for(var c=u.length,l=v(u,c),r=0;r<c;++r)n(l[r],this,t);return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,s,o;if(a(t),void 0===(n=this._events)||void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9664:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7437),i=r(2265),s=r(8885),o=r.n(s);class a{get started(){return!!this.state}async start(){try{let e=new AudioContext({sampleRate:48e3}),t=await navigator.mediaDevices.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}}),r=e.createMediaStreamSource(t),n=e.createAnalyser();n.fftSize=32768;let i=n.frequencyBinCount;r.connect(n),this.state={audioContext:e,analyser:n,mediaStreamSource:r,buffer:new Float32Array(i),bufferLength:i},this.updatePitchLoop()}catch(e){this.eventEmitter.emit("error",{error:e})}}async stop(){try{if(!this.state)return;this.state.animationFrameRequestId&&cancelAnimationFrame(this.state.animationFrameRequestId),this.state.analyser.disconnect(),this.state.mediaStreamSource.disconnect(),await this.state.audioContext.close(),this.state=void 0}catch(e){this.eventEmitter.emit("error",{error:e})}}addListener(e,t){this.eventEmitter.addListener(e,t)}removeListener(e,t){this.eventEmitter.removeListener(e,t)}updatePitchLoop(){try{if(!this.state)return;this.state.analyser.getFloatFrequencyData(this.state.buffer);let e=-1,t=-1/0;this.state.buffer.forEach((r,n)=>{r>t&&(t=r,e=n)});let r=48e3*e/(2*this.state.analyser.frequencyBinCount);-1!==e&&this.eventEmitter.emit("pitch",{frequency:r,db:t}),this.state.animationFrameRequestId=requestAnimationFrame(this.updatePitchLoop.bind(this))}catch(e){this.eventEmitter.emit("error",{error:e})}}constructor(){this.eventEmitter=new(o())}}function u(){let e=(0,i.useRef)(new a),[t,r]=(0,i.useState)(!1),[s,o]=(0,i.useState)(""),[u,c]=(0,i.useState)(""),l=(0,i.useRef)(-1/0),[f,h]=(0,i.useState)(0),d=+u*(2*f*+s/1e3)**2,v=(0,i.useCallback)(async()=>{h(0),l.current=-1/0,e.current.started&&await e.current.stop(),await e.current.start(),r(!0)},[]),p=(0,i.useCallback)(async()=>{await e.current.stop(),r(!1)},[]);return(0,i.useEffect)(()=>{e.current.addListener("pitch",e=>{let{frequency:t,db:r}=e;l.current<=r&&(l.current=r,h(Math.round(t)))})},[]),(0,n.jsxs)("main",{className:"flex flex-col items-center justify-start size-full bg-blue-950 text-white p-4",children:[(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start w-96 max-w-full mb-12",children:[(0,n.jsxs)("div",{className:"font-sans text-center text-white text-base",children:["Tension = ",Math.round(100*d)/100," N = ",Math.round(d/9.807*100)/100," KGF"]}),(0,n.jsxs)("div",{className:"font-sans text-center text-white text-base",children:["Frequency = ",f," HZ"]})]}),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start w-96 max-w-full mb-12",children:[(0,n.jsx)("div",{className:"font-sans text-white text-base",children:"Spoke length (mm)"}),(0,n.jsx)("input",{className:"font-sans text-white text-base border-white border-1 border-solid p-2 rounded",type:"number",value:s,onChange:e=>o(e.target.value)})]}),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start w-96 max-w-full mb-12",children:[(0,n.jsx)("div",{className:"font-sans text-white text-base",children:"Specific spoke density (kg/m)"}),(0,n.jsx)("input",{className:"font-sans text-white text-base border-white border-1 border-solid p-2 rounded",type:"number",value:u,onChange:e=>c(e.target.value)})]}),(0,n.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4",children:[t&&(0,n.jsx)("button",{onClick:p,className:"border-1 border-solid border-red-500 text-red-500 hover:border-red-600 hover:text-red-600 active:border-red-700 active:text-red-700 p-2 cursor-pointer rounded",children:"Stop"}),!t&&(0,n.jsx)("button",{disabled:t,onClick:v,className:"border-1 border-solid border-green-500 text-green-500 hover:border-green-600 hover:text-green-600 active:border-green-700 active:text-green-700 p-2 cursor-pointer rounded",children:"Start"})]})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=4100)}),_N_E=e.O()}]);